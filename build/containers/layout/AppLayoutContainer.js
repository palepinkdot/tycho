"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=require("react"),_propTypes=_interopRequireDefault(require("prop-types")),_mobxReact=require("mobx-react"),_reactJss=require("react-jss"),_AppStore=_interopRequireDefault(require("../../stores/AppStore")),_RecipesStore=_interopRequireDefault(require("../../stores/RecipesStore")),_ServicesStore=_interopRequireDefault(require("../../stores/ServicesStore")),_FeaturesStore=_interopRequireDefault(require("../../stores/FeaturesStore")),_UIStore=_interopRequireDefault(require("../../stores/UIStore")),_SettingsStore=_interopRequireDefault(require("../../stores/SettingsStore")),_UserStore=_interopRequireDefault(require("../../stores/UserStore")),_RequestStore=_interopRequireDefault(require("../../stores/RequestStore")),_GlobalErrorStore=_interopRequireDefault(require("../../stores/GlobalErrorStore")),_propTypes2=require("../../prop-types"),_AppLayout=_interopRequireDefault(require("../../components/layout/AppLayout")),_Sidebar=_interopRequireDefault(require("../../components/layout/Sidebar")),_Services=_interopRequireDefault(require("../../components/services/content/Services")),_AppLoader=_interopRequireDefault(require("../../components/ui/AppLoader")),_actions=require("../../features/workspaces/actions"),_WorkspaceDrawer=_interopRequireDefault(require("../../features/workspaces/components/WorkspaceDrawer")),_workspaces=require("../../features/workspaces"),_jsxRuntime=require("react/jsx-runtime");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}class AppLayoutContainer extends _react.Component{render(){const{app:e,features:r,services:t,ui:s,settings:i,globalError:a,requests:o,user:u,router:p}=this.props.stores;u.isLoggedIn||p.push("/auth/welcome");const{setActive:n,handleIPCMessage:l,setWebviewReference:d,detachService:c,openWindow:_,reorder:f,reload:q,toggleNotifications:S,toggleAudio:R,toggleDarkMode:g,deleteService:h,updateService:v,hibernate:w,awake:y}=this.props.actions.service,{retryRequiredRequests:m}=this.props.actions.requests,{installUpdate:D,toggleMuteApp:x}=this.props.actions.app,{openSettings:A,closeSettings:k}=this.props.actions.ui,{children:T}=this.props,b=r.featuresRequest.isExecuting&&!r.featuresRequest.wasExecuted,O=t.allServicesRequest.isExecuting&&t.allServicesRequest.isExecutingFirstTime;if(!i.loaded||b||O)return(0,_jsxRuntime.jsx)(_reactJss.ThemeProvider,{theme:s.theme,children:(0,_jsxRuntime.jsx)(_AppLoader.default,{})});const j=(0,_jsxRuntime.jsx)(_WorkspaceDrawer.default,{getServicesForWorkspace:e=>e?_workspaces.workspaceStore.getWorkspaceServices(e).map((e=>e.name)):t.all.map((e=>e.name))}),M=(0,_jsxRuntime.jsx)(_Sidebar.default,{services:t.allDisplayed,setActive:n,isAppMuted:i.all.app.isAppMuted,openSettings:A,closeSettings:k,reorder:f,reload:q,toggleNotifications:S,toggleAudio:R,toggleDarkMode:g,deleteService:h,updateService:v,hibernateService:w,wakeUpService:y,toggleMuteApp:x,toggleWorkspaceDrawer:_actions.workspaceActions.toggleWorkspaceDrawer,isWorkspaceDrawerOpen:_workspaces.workspaceStore.isWorkspaceDrawerOpen,showServicesUpdatedInfoBar:s.showServicesUpdatedInfoBar,showMessageBadgeWhenMutedSetting:i.all.app.showMessageBadgeWhenMuted,showServiceNameSetting:i.all.app.showServiceName,showMessageBadgesEvenWhenMuted:s.showMessageBadgesEvenWhenMuted,isTodosServiceActive:t.isTodosServiceActive||!1}),W=(0,_jsxRuntime.jsx)(_Services.default,{services:t.allDisplayedUnordered,handleIPCMessage:l,setWebviewReference:d,detachService:c,openWindow:_,reload:q,openSettings:A,update:v,userHasCompletedSignup:u.hasCompletedSignup,isSpellcheckerEnabled:i.app.enableSpellchecking});return(0,_jsxRuntime.jsx)(_reactJss.ThemeProvider,{theme:s.theme,children:(0,_jsxRuntime.jsx)(_AppLayout.default,{settings:i,isFullScreen:e.isFullScreen,isOnline:e.isOnline,showServicesUpdatedInfoBar:s.showServicesUpdatedInfoBar,appUpdateIsDownloaded:e.updateStatus===e.updateStatusTypes.DOWNLOADED,authRequestFailed:e.authRequestFailed,sidebar:M,workspacesDrawer:j,services:W,installAppUpdate:D,globalError:a.error,showRequiredRequestsError:o.showRequiredRequestsError,areRequiredRequestsSuccessful:o.areRequiredRequestsSuccessful,retryRequiredRequests:m,areRequiredRequestsLoading:o.areRequiredRequestsLoading,children:_react.Children.count(T)>0?T:null})})}}AppLayoutContainer.defaultProps={children:null},AppLayoutContainer.propTypes={stores:_propTypes.default.shape({services:_propTypes.default.instanceOf(_ServicesStore.default).isRequired,features:_propTypes.default.instanceOf(_FeaturesStore.default).isRequired,recipes:_propTypes.default.instanceOf(_RecipesStore.default).isRequired,app:_propTypes.default.instanceOf(_AppStore.default).isRequired,ui:_propTypes.default.instanceOf(_UIStore.default).isRequired,settings:_propTypes.default.instanceOf(_SettingsStore.default).isRequired,user:_propTypes.default.instanceOf(_UserStore.default).isRequired,requests:_propTypes.default.instanceOf(_RequestStore.default).isRequired,globalError:_propTypes.default.instanceOf(_GlobalErrorStore.default).isRequired}).isRequired,actions:_propTypes.default.shape({service:_propTypes.default.instanceOf(_ServicesStore.default).isRequired,ui:_propTypes.default.instanceOf(_UIStore.default).isRequired,app:_propTypes.default.instanceOf(_AppStore.default).isRequired,requests:_propTypes.default.instanceOf(_RequestStore.default).isRequired}).isRequired,children:_propTypes2.oneOrManyChildElements};var _default=(0,_mobxReact.inject)("stores","actions")((0,_mobxReact.observer)(AppLayoutContainer));exports.default=_default;