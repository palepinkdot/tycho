"use strict";var _class,_descriptor,_propTypes=_interopRequireDefault(require("prop-types")),_mobx=require("mobx"),_FeatureStore=require("./FeatureStore"),_actions=require("../../actions/lib/actions"),_ActionBinding=require("./ActionBinding"),_Reaction=require("../../stores/lib/Reaction");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _initializerDefineProperty(t,e,i,r){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function _applyDecoratedDescriptor(t,e,i,r,o){var n={};return Object.keys(r).forEach((function(t){n[t]=r[t]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce((function(i,r){return r(t,e,i)||i}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(t,e,n),n=null),n}function _initializerWarningHelper(t,e){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}const actions=(0,_actions.createActionsFromDefinitions)({countUp:{}},_propTypes.default.checkPropTypes);let TestFeatureStore=(_class=class extends _FeatureStore.FeatureStore{constructor(...t){super(...t),_initializerDefineProperty(this,"count",_descriptor,this),this.reactionInvokedCount=0,this._countUp=()=>{this.count+=1},this._countReaction=()=>{this.reactionInvokedCount+=1}}start(){this._registerActions((0,_ActionBinding.createActionBindings)([[actions.countUp,this._countUp]])),this._registerReactions((0,_Reaction.createReactions)([this._countReaction]))}},_descriptor=_applyDecoratedDescriptor(_class.prototype,"count",[_mobx.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_class);describe("FeatureStore",(()=>{let t=null;beforeEach((()=>{t=new TestFeatureStore})),describe("registering actions",(()=>{it("starts the actions",(()=>{t.start(),actions.countUp(),expect(t.count).toBe(1)})),it("starts the reactions",(()=>{t.start(),actions.countUp(),expect(t.reactionInvokedCount).toBe(1)}))})),describe("stopping the store",(()=>{it("stops the actions",(()=>{t.start(),actions.countUp(),t.stop(),actions.countUp(),expect(t.count).toBe(1)})),it("stops the reactions",(()=>{t.start(),actions.countUp(),t.stop(),t.count+=1,expect(t.reactionInvokedCount).toBe(1)}))})),describe("toggling the store",(()=>{it("restarts the actions correctly",(()=>{t.start(),actions.countUp(),t.stop(),actions.countUp(),t.start(),actions.countUp(),expect(t.count).toBe(2)})),it("restarts the reactions correctly",(()=>{t.start(),actions.countUp(),t.stop(),actions.countUp(),t.start(),actions.countUp(),expect(t.count).toBe(2)}))}))}));