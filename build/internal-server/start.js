"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.server=void 0;const tslib_1=require("tslib"),fold_1=(0,tslib_1.__importDefault)(require("@adonisjs/fold")),ignitor_1=require("@adonisjs/ignitor"),fs_extra_1=require("fs-extra"),path_1=require("path"),config_1=require("../config"),environment_1=require("../environment");process.env.ENV_PATH=(0,path_1.join)(__dirname,"env.ini");const server=async(e,r)=>{const t=(0,path_1.join)(e,"server.sqlite"),i=(0,path_1.join)(__dirname,"database","template.sqlite");if(!(0,fs_extra_1.existsSync)(t)){const e=await(0,fs_extra_1.readFile)(i);await(0,fs_extra_1.writeFile)(t,e),environment_1.isWindows&&(0,fs_extra_1.chmodSync)(t,146|(0,fs_extra_1.statSync)(t).mode)}process.env.DB_PATH=t,process.env.USER_PATH=e,process.env.HOST=config_1.LOCAL_HOSTNAME,process.env.PORT=r.toString(),new ignitor_1.Ignitor(fold_1.default).appRoot(__dirname).fireHttpServer().catch(console.error)};exports.server=server;