"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=require("react"),_propTypes=_interopRequireDefault(require("prop-types")),_mobxReact=require("mobx-react"),_reactIntl=require("react-intl"),_Form=_interopRequireDefault(require("../../lib/Form")),_validationHelpers=require("../../helpers/validation-helpers"),_Input=_interopRequireDefault(require("../ui/Input")),_Button=_interopRequireDefault(require("../ui/Button")),_Link=_interopRequireDefault(require("../ui/Link")),_propTypes2=require("../../prop-types"),_apiBase=require("../../api/apiBase"),_jsxRuntime=require("react/jsx-runtime");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const messages=(0,_reactIntl.defineMessages)({headline:{id:"signup.headline",defaultMessage:[{type:0,value:"Sign up"}]},firstnameLabel:{id:"signup.firstname.label",defaultMessage:[{type:0,value:"First Name"}]},lastnameLabel:{id:"signup.lastname.label",defaultMessage:[{type:0,value:"Last Name"}]},emailLabel:{id:"signup.email.label",defaultMessage:[{type:0,value:"Email address"}]},passwordLabel:{id:"signup.password.label",defaultMessage:[{type:0,value:"Password"}]},legalInfo:{id:"signup.legal.info",defaultMessage:[{type:0,value:"By creating a Ferdi account you accept the"}]},terms:{id:"signup.legal.terms",defaultMessage:[{type:0,value:"Terms of service"}]},privacy:{id:"signup.legal.privacy",defaultMessage:[{type:0,value:"Privacy Statement"}]},submitButtonLabel:{id:"signup.submit.label",defaultMessage:[{type:0,value:"Create account"}]},loginLink:{id:"signup.link.login",defaultMessage:[{type:0,value:"Already have an account, sign in?"}]},emailDuplicate:{id:"signup.emailDuplicate",defaultMessage:[{type:0,value:"A user with that email address already exists"}]}});class Signup extends _react.Component{constructor(...e){super(...e),this.form=new _Form.default({fields:{firstname:{label:this.props.intl.formatMessage(messages.firstnameLabel),value:"",validators:[_validationHelpers.required]},lastname:{label:this.props.intl.formatMessage(messages.lastnameLabel),value:"",validators:[_validationHelpers.required]},email:{label:this.props.intl.formatMessage(messages.emailLabel),value:"",validators:[_validationHelpers.required,_validationHelpers.email]},password:{label:this.props.intl.formatMessage(messages.passwordLabel),value:"",validators:[_validationHelpers.required,(0,_validationHelpers.minLength)(6)],type:"password"}}},this.props.intl)}submit(e){e.preventDefault(),this.form.submit({onSuccess:e=>{this.props.onSubmit(e.values())},onError:()=>{}})}render(){const{form:e}=this,{intl:s}=this.props,{isSubmitting:a,loginRoute:t,error:i}=this.props;return(0,_jsxRuntime.jsx)("div",{className:"auth__scroll-container",children:(0,_jsxRuntime.jsxs)("div",{className:"auth__container auth__container--signup",children:[(0,_jsxRuntime.jsxs)("form",{className:"franz-form auth__form",onSubmit:e=>this.submit(e),children:[(0,_jsxRuntime.jsx)(_Link.default,{to:"/auth/welcome",children:(0,_jsxRuntime.jsx)("img",{src:"./assets/images/logo.svg",className:"auth__logo",alt:""})}),(0,_jsxRuntime.jsx)("h1",{children:s.formatMessage(messages.headline)}),(0,_jsxRuntime.jsxs)("div",{className:"grid__row",children:[(0,_jsxRuntime.jsx)(_Input.default,{field:e.$("firstname"),focus:!0}),(0,_jsxRuntime.jsx)(_Input.default,{field:e.$("lastname")})]}),(0,_jsxRuntime.jsx)(_Input.default,{field:e.$("email")}),(0,_jsxRuntime.jsx)(_Input.default,{field:e.$("password"),showPasswordToggle:!0,scorePassword:!0}),"email-duplicate"===i.code&&(0,_jsxRuntime.jsx)("p",{className:"error-message center",children:s.formatMessage(messages.emailDuplicate)}),a?(0,_jsxRuntime.jsx)(_Button.default,{className:"auth__button is-loading",label:`${s.formatMessage(messages.submitButtonLabel)} ...`,loaded:!1,disabled:!0}):(0,_jsxRuntime.jsx)(_Button.default,{type:"submit",className:"auth__button",label:s.formatMessage(messages.submitButtonLabel)}),(0,_jsxRuntime.jsxs)("p",{className:"legal",children:[s.formatMessage(messages.legalInfo),(0,_jsxRuntime.jsx)("br",{}),(0,_jsxRuntime.jsx)(_Link.default,{to:`${(0,_apiBase.termsBase)()}/terms`,target:"_blank",className:"link",children:s.formatMessage(messages.terms)})," & ",(0,_jsxRuntime.jsx)(_Link.default,{to:`${(0,_apiBase.termsBase)()}/privacy`,target:"_blank",className:"link",children:s.formatMessage(messages.privacy)}),"."]})]}),(0,_jsxRuntime.jsx)("div",{className:"auth__links",children:(0,_jsxRuntime.jsx)(_Link.default,{to:t,children:s.formatMessage(messages.loginLink)})})]})})}}Signup.propTypes={onSubmit:_propTypes.default.func.isRequired,isSubmitting:_propTypes.default.bool.isRequired,loginRoute:_propTypes.default.string.isRequired,error:_propTypes2.globalError.isRequired};var _default=(0,_reactIntl.injectIntl)((0,_mobxReact.inject)("actions")((0,_mobxReact.observer)(Signup)));exports.default=_default;