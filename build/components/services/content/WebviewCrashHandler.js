"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=require("react"),_propTypes=_interopRequireDefault(require("prop-types")),_mobxReact=require("mobx-react"),_reactIntl=require("react-intl"),_ms=_interopRequireDefault(require("ms")),_Button=_interopRequireDefault(require("../../ui/Button")),_jsxRuntime=require("react/jsx-runtime");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const messages=(0,_reactIntl.defineMessages)({headline:{id:"service.crashHandler.headline",defaultMessage:[{type:0,value:"Oh no!"}]},text:{id:"service.crashHandler.text",defaultMessage:[{type:1,value:"name"},{type:0,value:" has caused an error."}]},action:{id:"service.crashHandler.action",defaultMessage:[{type:0,value:"Reload "},{type:1,value:"name"}]},autoReload:{id:"service.crashHandler.autoReload",defaultMessage:[{type:0,value:"Trying to automatically restore "},{type:1,value:"name"},{type:0,value:" in "},{type:1,value:"seconds"},{type:0,value:" seconds"}]}});class WebviewCrashHandler extends _react.Component{constructor(...e){super(...e),this.state={countdown:(0,_ms.default)("10s")},this.countdownInterval=null,this.countdownIntervalTimeout=(0,_ms.default)("1s")}componentDidMount(){const{reload:e}=this.props;this.countdownInterval=setInterval((()=>{this.setState((e=>({countdown:e.countdown-this.countdownIntervalTimeout}))),this.state.countdown<=0&&(e(),clearInterval(this.countdownInterval))}),this.countdownIntervalTimeout)}render(){const{name:e,reload:t}=this.props,{intl:s}=this.props;return(0,_jsxRuntime.jsxs)("div",{className:"services__info-layer",children:[(0,_jsxRuntime.jsx)("h1",{children:s.formatMessage(messages.headline)}),(0,_jsxRuntime.jsx)("p",{children:s.formatMessage(messages.text,{name:e})}),(0,_jsxRuntime.jsx)(_Button.default,{label:s.formatMessage(messages.action,{name:e}),buttonType:"inverted",onClick:()=>t()}),(0,_jsxRuntime.jsx)("p",{className:"footnote",children:s.formatMessage(messages.autoReload,{name:e,seconds:this.state.countdown/(0,_ms.default)("1s")})})]})}}WebviewCrashHandler.propTypes={name:_propTypes.default.string.isRequired,reload:_propTypes.default.func.isRequired};var _default=(0,_reactIntl.injectIntl)((0,_mobxReact.observer)(WebviewCrashHandler));exports.default=_default;