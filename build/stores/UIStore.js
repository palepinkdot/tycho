"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _class,_descriptor,_descriptor2,_mobx=require("mobx"),_remote=require("@electron/remote"),_themes=require("../themes"),_Store=_interopRequireDefault(require("./lib/Store"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _initializerDefineProperty(e,t,s,r){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(r):void 0})}function _applyDecoratedDescriptor(e,t,s,r,o){var i={};return Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=s.slice().reverse().reduce((function(s,r){return r(e,t,s)||s}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}function _initializerWarningHelper(e,t){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and runs after the decorators transform.")}let UIStore=(_class=class extends _Store.default{constructor(...e){super(...e),_initializerDefineProperty(this,"showServicesUpdatedInfoBar",_descriptor,this),_initializerDefineProperty(this,"isOsDarkThemeActive",_descriptor2,this),this.actions.ui.openSettings.listen(this._openSettings.bind(this)),this.actions.ui.closeSettings.listen(this._closeSettings.bind(this)),this.actions.ui.toggleServiceUpdatedInfoBar.listen(this._toggleServiceUpdatedInfoBar.bind(this)),_remote.nativeTheme.on("updated",(()=>{this.isOsDarkThemeActive=_remote.nativeTheme.shouldUseDarkColors,this.actions.service.shareSettingsWithServiceProcess()}))}setup(){(0,_mobx.reaction)((()=>this.isDarkThemeActive),(()=>{this._setupThemeInDOM()}),{fireImmediately:!0}),(0,_mobx.reaction)((()=>this.isSplitModeActive),(()=>{this._setupModeInDOM()}),{fireImmediately:!0}),(0,_mobx.reaction)((()=>this.splitColumnsNo),(()=>{this._setupColumnsInDOM()}),{fireImmediately:!0})}get showMessageBadgesEvenWhenMuted(){const e=this.stores.settings.all;return e.app.isAppMuted&&e.app.showMessageBadgeWhenMuted||!e.app.isAppMuted}get isDarkThemeActive(){const e=this.stores.settings.all.app.adaptableDarkMode&&this.isOsDarkThemeActive,t=this.stores.settings.all.app.darkMode&&!this.stores.settings.all.app.adaptableDarkMode,s=this.stores.settings.all.app.darkMode;return!!(e||t||s)}get isSplitModeActive(){return this.stores.settings.app.splitMode}get splitColumnsNo(){return this.stores.settings.app.splitColumns}get theme(){const e=this.isDarkThemeActive||this.stores.settings.app.darkMode?_themes.ThemeType.dark:_themes.ThemeType.default,{accentColor:t}=this.stores.settings.app;return(0,_themes.theme)(e,t)}_openSettings({path:e="/settings"}){const t="/settings"!==e?`/settings/${e}`:e;this.stores.router.push(t)}_closeSettings(){this.stores.router.push("/")}_toggleServiceUpdatedInfoBar({visible:e}){let t=e;null===t&&(t=!this.showServicesUpdatedInfoBar),this.showServicesUpdatedInfoBar=t}_setupThemeInDOM(){this.isDarkThemeActive?document.body.classList.add("theme__dark"):document.body.classList.remove("theme__dark")}_setupModeInDOM(){this.isSplitModeActive?(document.body.classList.add("mode__split"),document.body.dataset.columns=this.splitColumnsNo):document.body.classList.remove("mode__split")}_setupColumnsInDOM(){document.body.dataset.columns=this.splitColumnsNo}},_descriptor=_applyDecoratedDescriptor(_class.prototype,"showServicesUpdatedInfoBar",[_mobx.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor2=_applyDecoratedDescriptor(_class.prototype,"isOsDarkThemeActive",[_mobx.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return _remote.nativeTheme.shouldUseDarkColors}}),_applyDecoratedDescriptor(_class.prototype,"showMessageBadgesEvenWhenMuted",[_mobx.computed],Object.getOwnPropertyDescriptor(_class.prototype,"showMessageBadgesEvenWhenMuted"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"isDarkThemeActive",[_mobx.computed],Object.getOwnPropertyDescriptor(_class.prototype,"isDarkThemeActive"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"isSplitModeActive",[_mobx.computed],Object.getOwnPropertyDescriptor(_class.prototype,"isSplitModeActive"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"splitColumnsNo",[_mobx.computed],Object.getOwnPropertyDescriptor(_class.prototype,"splitColumnsNo"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"theme",[_mobx.computed],Object.getOwnPropertyDescriptor(_class.prototype,"theme"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_openSettings",[_mobx.action],Object.getOwnPropertyDescriptor(_class.prototype,"_openSettings"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_closeSettings",[_mobx.action],Object.getOwnPropertyDescriptor(_class.prototype,"_closeSettings"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"_toggleServiceUpdatedInfoBar",[_mobx.action],Object.getOwnPropertyDescriptor(_class.prototype,"_toggleServiceUpdatedInfoBar"),_class.prototype),_class);exports.default=UIStore;